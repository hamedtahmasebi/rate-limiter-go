2025/11/01 16:41:41 main.go:30: Logger Initialized
2025/11/01 16:41:41 parser.go:51: max tokens = 100
2025/11/01 16:41:41 parser.go:51: max tokens = 100
2025/11/01 16:41:41 main.go:48: event=init action=NewServiceRegistry
2025/11/01 16:41:41 main.go:50: event=init action=NewBucketStorage
2025/11/01 16:41:41 persist.go:38: level=error event=read_file filepath=./persistence_files/persistence_files/test_service_web_app_u23.json err="open ./persistence_files/persistence_files/test_service_web_app_u23.json: no such file or directory"
2025/11/01 16:41:41 main.go:77: level=error event=load_persisted_bucket status=error error="open ./persistence_files/persistence_files/test_service_web_app_u23.json: no such file or directory"
2025/11/01 16:41:41 main.go:106: event=create_service id="test_service" usage_price_in_tokens=1
2025/11/01 16:41:41 service_registry.go:36: action=create_service id="test_service" usage_price_in_tokens=1
2025/11/01 16:41:41 main.go:106: event=create_service id="test_service" usage_price_in_tokens=1
2025/11/01 16:41:41 service_registry.go:36: action=create_service id="test_service" usage_price_in_tokens=1
2025/11/01 16:41:41 main.go:117: event=server_setup status=starting
2025/11/01 16:41:41 main.go:129: event=server status=listening port=":50051"
2025/11/01 16:41:45 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:45 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:45 token_bucket.go:80: event=create_bucket bucket_id="test_service_web_app_u23" initial_tokens=100 refill_rate_per_second=1 max_tokens=100
2025/11/01 16:41:45 token_bucket.go:96: event=bucket_created bucket_id="test_service_web_app_u23"
2025/11/01 16:41:45 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:45 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:45 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=100 usage_price=1
2025/11/01 16:41:45 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=90
2025/11/01 16:41:45 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:46 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:46 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:46 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:46 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:46 token_bucket.go:160: event=bucket_refilled bucket_id=test_service_web_app_u23 tokens_added=1 new_tokens=91
2025/11/01 16:41:46 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=91 usage_price=1
2025/11/01 16:41:46 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=81
2025/11/01 16:41:46 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:46 main.go:93: level=info event=periodic_save start saving 1 buckets
2025/11/01 16:41:47 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:47 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:47 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:47 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:47 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=81 usage_price=1
2025/11/01 16:41:47 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=71
2025/11/01 16:41:47 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:48 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:48 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:48 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:48 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:48 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=71 usage_price=1
2025/11/01 16:41:48 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=61
2025/11/01 16:41:48 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:49 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:49 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:49 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:49 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:49 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=61 usage_price=1
2025/11/01 16:41:49 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=51
2025/11/01 16:41:49 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:50 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:50 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:50 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:50 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:50 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=51 usage_price=1
2025/11/01 16:41:50 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=41
2025/11/01 16:41:50 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:51 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:51 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:51 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:51 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:51 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=41 usage_price=1
2025/11/01 16:41:51 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=31
2025/11/01 16:41:51 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:51 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:51 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:51 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:51 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:51 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=31 usage_price=1
2025/11/01 16:41:51 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=21
2025/11/01 16:41:51 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:51 main.go:93: level=info event=periodic_save start saving 1 buckets
2025/11/01 16:41:52 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:52 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:52 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:52 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:52 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=21 usage_price=1
2025/11/01 16:41:52 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=11
2025/11/01 16:41:52 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:53 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:53 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:53 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:53 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:53 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=11 usage_price=1
2025/11/01 16:41:53 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=1
2025/11/01 16:41:53 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:41:54 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:54 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:54 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:54 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:54 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=1 usage_price=1
2025/11/01 16:41:54 token_bucket.go:130: event=insufficient_tokens service_id=test_service client_id=web_app user_id=u23 tokens=1 retry_after=9
2025/11/01 16:41:54 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=false retry_after=9
2025/11/01 16:41:55 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:55 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:55 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:55 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:55 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=1 usage_price=1
2025/11/01 16:41:55 token_bucket.go:130: event=insufficient_tokens service_id=test_service client_id=web_app user_id=u23 tokens=1 retry_after=9
2025/11/01 16:41:55 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=false retry_after=9
2025/11/01 16:41:56 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:41:56 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:56 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:41:56 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:41:56 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=1 usage_price=1
2025/11/01 16:41:56 token_bucket.go:130: event=insufficient_tokens service_id=test_service client_id=web_app user_id=u23 tokens=1 retry_after=9
2025/11/01 16:41:56 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=false retry_after=9
2025/11/01 16:41:56 main.go:93: level=info event=periodic_save start saving 1 buckets
2025/11/01 16:42:00 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:42:00 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:00 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:42:00 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:00 token_bucket.go:160: event=bucket_refilled bucket_id=test_service_web_app_u23 tokens_added=4 new_tokens=5
2025/11/01 16:42:00 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=5 usage_price=1
2025/11/01 16:42:00 token_bucket.go:130: event=insufficient_tokens service_id=test_service client_id=web_app user_id=u23 tokens=5 retry_after=5
2025/11/01 16:42:00 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=false retry_after=5
2025/11/01 16:42:01 main.go:93: level=info event=periodic_save start saving 1 buckets
2025/11/01 16:42:04 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:42:04 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:04 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:42:04 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:04 token_bucket.go:160: event=bucket_refilled bucket_id=test_service_web_app_u23 tokens_added=3 new_tokens=8
2025/11/01 16:42:04 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=8 usage_price=1
2025/11/01 16:42:04 token_bucket.go:130: event=insufficient_tokens service_id=test_service client_id=web_app user_id=u23 tokens=8 retry_after=2
2025/11/01 16:42:04 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=false retry_after=2
2025/11/01 16:42:06 main.go:93: level=info event=periodic_save start saving 1 buckets
2025/11/01 16:42:08 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:42:08 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:08 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:42:08 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:08 token_bucket.go:160: event=bucket_refilled bucket_id=test_service_web_app_u23 tokens_added=4 new_tokens=12
2025/11/01 16:42:08 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=12 usage_price=1
2025/11/01 16:42:08 token_bucket.go:136: event=consume_tokens client_id=web_app service_id=test_service user_id=u23 tokens_consumed=10 tokens_left=2
2025/11/01 16:42:08 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=true retry_after=0
2025/11/01 16:42:09 server.go:16: level=info event=get_access_status service_id=test_service client_id=web_app user_id=u23 usage_amount=10
2025/11/01 16:42:09 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:09 token_bucket.go:102: event=consume_service status=started client_id=web_app user_id=u23
2025/11/01 16:42:09 service_registry.go:60: action=get_service id="test_service"
2025/11/01 16:42:09 token_bucket.go:160: event=bucket_refilled bucket_id=test_service_web_app_u23 tokens_added=1 new_tokens=3
2025/11/01 16:42:09 token_bucket.go:125: event=get_bucket_status service_id=test_service client_id=web_app user_id=u23 tokens=3 usage_price=1
2025/11/01 16:42:09 token_bucket.go:130: event=insufficient_tokens service_id=test_service client_id=web_app user_id=u23 tokens=3 retry_after=7
2025/11/01 16:42:09 server.go:49: level=info event=get_access_status status=success client_id="web_app" service_id="test_service": allowed=false retry_after=7
2025/11/01 16:42:11 main.go:93: level=info event=periodic_save start saving 1 buckets
